<div id=booru-posts class=row>
    {% for post in query.result.posts %}
    <div class='col-sm-2 booru-post'>
        <div class='thumbnail'>
            <a href='{{ post_uri_template.format(post.id) }}' target=_blank><img alt='{{ tags(post) }}' src='{{ preview_url(post) }}'></a>
        </div>
    </div>
    {% endfor %}
</div>
<p>以上是全部搜索结果中的{{ len(query.result.posts) }}个, 完整列表参见<a href='{{ query.result.uri }}' target=_blank>这里</a>.</p>
<script src='//cdnjs.cloudflare.com/ajax/libs/masonry/3.1.2/masonry.pkgd.js'></script>
<script src='//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/3.0.4/jquery.imagesloaded.min.js'></script>
<script>
    $(function() {
        var $container = $('#booru-posts');
        $container.masonry({
            columnWidth: $container.find('.booru-post').outerWidth(),
            itemSelector: '.booru-post'
        });
        $container.find('.booru-post').each(function() {
            $(this).imagesLoaded(function() {
                $container.masonry();
            });
        });
    });
</script>
